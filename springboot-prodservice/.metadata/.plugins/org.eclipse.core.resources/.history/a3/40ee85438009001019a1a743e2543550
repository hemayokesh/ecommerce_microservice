package com.springboot.product.springbootproduct;

import java.util.List;
import java.util.stream.Collectors;

import org.springframework.stereotype.Service;

import lombok.RequiredArgsConstructor;

@Service
@RequiredArgsConstructor
public class ProductService {
    private final ProductRepository productRepository = null;
    private final InventoryClient inventoryClient = null;

    public List<ProductEntity> getAvailableProducts() {
//        List<ProductEntity> products = productRepository.findAll();
//        
//        if (products.isEmpty()) {
//            throw new ProductNotFoundException("No products available in the catalog.");
//        }
//
//        return products.stream()
//                .filter(product -> inventoryClient.checkStock(product.getSkuCode()))
//                .toList();
    	
    	return productRepository.findAll().stream()
              .filter(product -> inventoryClient.checkStock(product.getId().toString()))
              .collect(Collectors.toList());
    }

    public ProductEntity saveProduct(ProductEntity product) {
        return productRepository.save(product);
    }
    
    

}
